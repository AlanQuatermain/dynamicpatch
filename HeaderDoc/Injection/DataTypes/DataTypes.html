<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
    "http://www.w3.org/TR/1998/REC-html40-19980424/loose.dtd">
<html><head>
    <title>Defined Types</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
 <meta name="generator" content="HeaderDoc">
<style type="text/css"><!--a:link {text-decoration: none; font-family: lucida grande, geneva, helvetica, arial, sans-serif; font-size: small; color: #0000ff;}a:visited {text-decoration: none; font-family: lucida grande, geneva, helvetica, arial, sans-serif; font-size: small; color: #0000ff;}a:visited:hover {text-decoration: underline; font-family: lucida grande, geneva, helvetica, arial, sans-serif; font-size: small; color: #ff6600;}a:active {text-decoration: none; font-family: lucida grande, geneva, helvetica, arial, sans-serif; font-size: small; color: #ff6600;}a:hover {text-decoration: underline; font-family: lucida grande, geneva, helvetica, arial, sans-serif; font-size: small; color: #ff6600;}h4 {text-decoration: none; font-family: lucida grande, geneva, helvetica, arial, sans-serif; font-size: tiny; font-weight: bold;}body {text-decoration: none; font-family: lucida grande, geneva, helvetica, arial, sans-serif; font-size: 10pt;}--></style></head><body bgcolor="#ffffff">
<h1><font face="Geneva,Arial,Helvtica">Defined Types</font></h1><br>
<hr><!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/__bundle_start_fn;  name=__bundle_start_fn -->
<a name="//apple_ref/c/tdef/__bundle_start_fn"></a>
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5"><h3><a name="__bundle_start_fn">__bundle_start_fn</a></h3>
</td></tr></table><hr><dl></dl><p>Function type for native patch bundle entry point.
</p>
<blockquote><pre><font class="keyword">typedef</font> <!-- a logicalPath="//apple_ref/c/cl/int //apple_ref/c/cl/int //apple_ref/c/tdef/int //apple_ref/c/tag/int //apple_ref/c/econst/int //apple_ref/c/struct/int //apple_ref/c/clconst/int" --><font class="type">int</font><!-- /a --> (*<!-- a logicalPath="//apple_ref/c/instm/__bundle_start_fn //apple_ref/c/clm/__bundle_start_fn //apple_ref/c/intfcm/__bundle_start_fn //apple_ref/c/func/__bundle_start_fn //apple_ref/c/ftmplt/__bundle_start_fn //apple_ref/c/defn/__bundle_start_fn //apple_ref/c/macro/__bundle_start_fn" --><font class="function">__bundle_start_fn</font><!-- /a -->)(
    <!-- a logicalPath="//apple_ref/c/cl/CFBundleRef //apple_ref/c/cl/CFBundleRef //apple_ref/c/tdef/CFBundleRef //apple_ref/c/tag/CFBundleRef //apple_ref/c/econst/CFBundleRef //apple_ref/c/struct/CFBundleRef //apple_ref/c/clconst/CFBundleRef" --><font class="type">CFBundleRef</font><!-- /a --> <font class="param">b</font>); </pre></blockquote>
<h5><font face="Lucida Grande,Helvetica,Arial">Parameter Descriptions</font></h5>
<blockquote>
<dl><dt><code>b</code></dt><dd>The patch bundle's object.</dd>
</dl>
</blockquote>
<dl><dt><i> result</i></dt><dd>Return 1 to stay in memory, 0 to be unloaded.
 </dd>
<h5><font face="Lucida Grande,Helvetica,Arial">Discussion</font></h5><p>Upon being loaded by this API, the bundle is expected to
export a function whose name matches the value of
<!-- a logicalPath="//apple_ref/c/macro/kStartFunctionName" -->kStartFunctionName <!-- /a -->. It
should conform to this prototype.
</p>
</dl>
<hr><!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/__bundle_will_patch_fn;  name=__bundle_will_patch_fn -->
<a name="//apple_ref/c/tdef/__bundle_will_patch_fn"></a>
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5"><h3><a name="__bundle_will_patch_fn">__bundle_will_patch_fn</a></h3>
</td></tr></table><hr><dl></dl><p>Prototype for Rosetta patch bundles.
</p>
<blockquote><pre><font class="keyword">typedef</font> <!-- a logicalPath="//apple_ref/c/cl/int //apple_ref/c/cl/int //apple_ref/c/tdef/int //apple_ref/c/tag/int //apple_ref/c/econst/int //apple_ref/c/struct/int //apple_ref/c/clconst/int" --><font class="type">int</font><!-- /a --> (*<!-- a logicalPath="//apple_ref/c/instm/__bundle_will_patch_fn //apple_ref/c/clm/__bundle_will_patch_fn //apple_ref/c/intfcm/__bundle_will_patch_fn //apple_ref/c/func/__bundle_will_patch_fn //apple_ref/c/ftmplt/__bundle_will_patch_fn //apple_ref/c/defn/__bundle_will_patch_fn //apple_ref/c/macro/__bundle_will_patch_fn" --><font class="function">__bundle_will_patch_fn</font><!-- /a -->)(
    <!-- a logicalPath="//apple_ref/c/cl/CFBundleRef //apple_ref/c/cl/CFBundleRef //apple_ref/c/tdef/CFBundleRef //apple_ref/c/tag/CFBundleRef //apple_ref/c/econst/CFBundleRef //apple_ref/c/struct/CFBundleRef //apple_ref/c/clconst/CFBundleRef" --><font class="type">CFBundleRef</font><!-- /a --> <font class="param">b</font>,
    <!-- a logicalPath="//apple_ref/c/cl/pid_t //apple_ref/c/cl/pid_t //apple_ref/c/tdef/pid_t //apple_ref/c/tag/pid_t //apple_ref/c/econst/pid_t //apple_ref/c/struct/pid_t //apple_ref/c/clconst/pid_t" --><font class="type">pid_t</font><!-- /a --> <font class="param">p</font>,
    <font class="keyword">const</font> <!-- a logicalPath="//apple_ref/c/cl/char //apple_ref/c/cl/char //apple_ref/c/tdef/char //apple_ref/c/tag/char //apple_ref/c/econst/char //apple_ref/c/struct/char //apple_ref/c/clconst/char" --><font class="type">char</font><!-- /a --> *<font class="param">a</font>); </pre></blockquote>
<h5><font face="Lucida Grande,Helvetica,Arial">Parameter Descriptions</font></h5>
<blockquote>
<dl><dt><code>b</code></dt><dd>The bundle object for the patch bundle.</dd>
<dt><code>p</code></dt><dd>The ID of the target process.</dd>
<dt><code>a</code></dt><dd>The name of the target process.</dd>
</dl>
</blockquote>
<dl><dt><i> result</i></dt><dd>Return 1 if you will patch the target, 0 otherwise.
 </dd>
<h5><font face="Lucida Grande,Helvetica,Arial">Discussion</font></h5><p>The patching system expects to find a function whose name
matches the value of
<!-- a logicalPath="//apple_ref/c/macro/kWillPatchFunctionName" -->kWillPatchFunctionName <!-- /a -->,
which should conform to this prototype.
</p>
</dl>
<hr><!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/__get_patch_details_fn;  name=__get_patch_details_fn -->
<a name="//apple_ref/c/tdef/__get_patch_details_fn"></a>
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5"><h3><a name="__get_patch_details_fn">__get_patch_details_fn</a></h3>
</td></tr></table><hr><dl></dl><p>Prototype for a function used to get Rosetta patch details.
</p>
<blockquote><pre><font class="keyword">typedef</font> <!-- a logicalPath="//apple_ref/c/cl/void //apple_ref/c/cl/void //apple_ref/c/tdef/void //apple_ref/c/tag/void //apple_ref/c/econst/void //apple_ref/c/struct/void //apple_ref/c/clconst/void" --><font class="type">void</font><!-- /a --> (*<!-- a logicalPath="//apple_ref/c/instm/__get_patch_details_fn //apple_ref/c/clm/__get_patch_details_fn //apple_ref/c/intfcm/__get_patch_details_fn //apple_ref/c/func/__get_patch_details_fn //apple_ref/c/ftmplt/__get_patch_details_fn //apple_ref/c/defn/__get_patch_details_fn //apple_ref/c/macro/__get_patch_details_fn" --><font class="function">__get_patch_details_fn</font><!-- /a -->)(
    <!-- a logicalPath="//apple_ref/c/cl/__patch_details_cb //apple_ref/c/cl/__patch_details_cb //apple_ref/c/tdef/__patch_details_cb //apple_ref/c/tag/__patch_details_cb //apple_ref/c/econst/__patch_details_cb //apple_ref/c/struct/__patch_details_cb //apple_ref/c/clconst/__patch_details_cb" --><font class="type">__patch_details_cb</font><!-- /a --> <font class="param">cb</font>,
    <!-- a logicalPath="//apple_ref/c/cl/int //apple_ref/c/cl/int //apple_ref/c/tdef/int //apple_ref/c/tag/int //apple_ref/c/econst/int //apple_ref/c/struct/int //apple_ref/c/clconst/int" --><font class="type">int</font><!-- /a --> <font class="param">arch</font>,
    <!-- a logicalPath="//apple_ref/c/cl/void //apple_ref/c/cl/void //apple_ref/c/tdef/void //apple_ref/c/tag/void //apple_ref/c/econst/void //apple_ref/c/struct/void //apple_ref/c/clconst/void" --><font class="type">void</font><!-- /a --> *<font class="param">info</font>); </pre></blockquote>
<h5><font face="Lucida Grande,Helvetica,Arial">Parameter Descriptions</font></h5>
<blockquote>
<dl><dt><code>cb</code></dt><dd>The function to call with details of each prospective patch.</dd>
<dt><code>arch</code></dt><dd>The architecture to use when looking up function addresses.</dd>
<dt><code>info</code></dt><dd>This should be passed back into the callback untouched.</dd>
</dl>
</blockquote>
<dl><h5><font face="Lucida Grande,Helvetica,Arial">Discussion</font></h5><p>The Rosetta patching implementation will look for a
function whose name matches the value of
<!-- a logicalPath="//apple_ref/c/macro/kGetPatchDetailsFunctionName" -->kGetPatchDetailsFunctionName <!-- /a -->
within the patch bundle. It will then call that function,
providing a callback the bundle can use to tell the injector
which functions to patch.
</p>
</dl>
<hr><!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/__patch_details_cb;  name=__patch_details_cb -->
<a name="//apple_ref/c/tdef/__patch_details_cb"></a>
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5"><h3><a name="__patch_details_cb">__patch_details_cb</a></h3>
</td></tr></table><hr><dl></dl><p>A callback, used by a Rosetta patch bundle.
</p>
<blockquote><pre><font class="keyword">typedef</font> <!-- a logicalPath="//apple_ref/c/cl/void //apple_ref/c/cl/void //apple_ref/c/tdef/void //apple_ref/c/tag/void //apple_ref/c/econst/void //apple_ref/c/struct/void //apple_ref/c/clconst/void" --><font class="type">void</font><!-- /a --> (*<!-- a logicalPath="//apple_ref/c/instm/__patch_details_cb //apple_ref/c/clm/__patch_details_cb //apple_ref/c/intfcm/__patch_details_cb //apple_ref/c/func/__patch_details_cb //apple_ref/c/ftmplt/__patch_details_cb //apple_ref/c/defn/__patch_details_cb //apple_ref/c/macro/__patch_details_cb" --><font class="function">__patch_details_cb</font><!-- /a -->)(
    <!-- a logicalPath="//apple_ref/c/cl/void //apple_ref/c/cl/void //apple_ref/c/tdef/void //apple_ref/c/tag/void //apple_ref/c/econst/void //apple_ref/c/struct/void //apple_ref/c/clconst/void" --><font class="type">void</font><!-- /a --> *<font class="param">addr</font>,
    <font class="keyword">const</font> <!-- a logicalPath="//apple_ref/c/cl/char //apple_ref/c/cl/char //apple_ref/c/tdef/char //apple_ref/c/tag/char //apple_ref/c/econst/char //apple_ref/c/struct/char //apple_ref/c/clconst/char" --><font class="type">char</font><!-- /a --> *<font class="param">name</font>,
    <!-- a logicalPath="//apple_ref/c/cl/void //apple_ref/c/cl/void //apple_ref/c/tdef/void //apple_ref/c/tag/void //apple_ref/c/econst/void //apple_ref/c/struct/void //apple_ref/c/clconst/void" --><font class="type">void</font><!-- /a --> *<font class="param">info</font>); </pre></blockquote>
<h5><font face="Lucida Grande,Helvetica,Arial">Parameter Descriptions</font></h5>
<blockquote>
<dl><dt><code>addr</code></dt><dd>The arch-specific address of the function to patch.</dd>
<dt><code>name</code></dt><dd>The name of the patch function exported by the bundle.</dd>
<dt><code>info</code></dt><dd>An info value, supplied to the patch bundle by the caller.</dd>
</dl>
</blockquote>
<dl><h5><font face="Lucida Grande,Helvetica,Arial">Discussion</font></h5><p>The patch bundle will be given a pointer to a function
with this prototype. It should call this function with the
details of any functions it wishes to patch in the target
process.
</p>
</dl>
<hr><!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/patch_link_fn_t;  name=patch_link_fn_t -->
<a name="//apple_ref/c/tdef/patch_link_fn_t"></a>
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5"><h3><a name="patch_link_fn_t">patch_link_fn_t</a></h3>
</td></tr></table><hr><dl></dl><p>Implemented by a Rosetta bundle to link to reentry islands.
</p>
<blockquote><pre><font class="keyword">typedef</font> <!-- a logicalPath="//apple_ref/c/cl/void //apple_ref/c/cl/void //apple_ref/c/tdef/void //apple_ref/c/tag/void //apple_ref/c/econst/void //apple_ref/c/struct/void //apple_ref/c/clconst/void" --><font class="type">void</font><!-- /a --> (*<!-- a logicalPath="//apple_ref/c/instm/patch_link_fn_t //apple_ref/c/clm/patch_link_fn_t //apple_ref/c/intfcm/patch_link_fn_t //apple_ref/c/func/patch_link_fn_t //apple_ref/c/ftmplt/patch_link_fn_t //apple_ref/c/defn/patch_link_fn_t //apple_ref/c/macro/patch_link_fn_t" --><font class="function">patch_link_fn_t</font><!-- /a -->)(
    <!-- a logicalPath="//apple_ref/c/cl/patch_lookup_fn_t //apple_ref/c/cl/patch_lookup_fn_t //apple_ref/c/tdef/patch_lookup_fn_t //apple_ref/c/tag/patch_lookup_fn_t //apple_ref/c/econst/patch_lookup_fn_t //apple_ref/c/struct/patch_lookup_fn_t //apple_ref/c/clconst/patch_lookup_fn_t" --><font class="type">patch_lookup_fn_t</font><!-- /a --> <font class="param">fn</font>,
    <font class="keyword">const</font> <!-- a logicalPath="//apple_ref/c/cl/char //apple_ref/c/cl/char //apple_ref/c/tdef/char //apple_ref/c/tag/char //apple_ref/c/econst/char //apple_ref/c/struct/char //apple_ref/c/clconst/char" --><font class="type">char</font><!-- /a --> *<font class="param">exec_path</font> ); </pre></blockquote>
<h5><font face="Lucida Grande,Helvetica,Arial">Parameter Descriptions</font></h5>
<blockquote>
<dl><dt><code>fn</code></dt><dd>A <!-- a logicalPath="//apple_ref/c/tdef/patch_lookup_fn_t" -->callback <!-- /a --> to retrieve
reentry addresses.</dd>
<dt><code>exec_path</code></dt><dd>The path to this bundle's executable file.</dd>
</dl>
</blockquote>
<dl><h5><font face="Lucida Grande,Helvetica,Arial">Discussion</font></h5><p>This function is implemented by the Rosetta patch bundle,
and is called to give it the opportunity to link its re-entry
function pointers; it is called when the bundle is first
loaded into the target application's address space. It is
given a <!-- a logicalPath="//apple_ref/c/tdef/patch_lookup_fn_t" -->callback <!-- /a --> to use when
requesting these addresses, and is given its own executable
path (within its bundle), such that it can recreate the
CFBundleRef it would be passed in the native patching
environment if so desired.
</p>
</dl>
<hr><!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/patch_lookup_fn_t;  name=patch_lookup_fn_t -->
<a name="//apple_ref/c/tdef/patch_lookup_fn_t"></a>
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5"><h3><a name="patch_lookup_fn_t">patch_lookup_fn_t</a></h3>
</td></tr></table><hr><dl></dl><p>Callback used by a rosetta bundle to get reentry addresses.
</p>
<blockquote><pre><font class="keyword">typedef</font> <!-- a logicalPath="//apple_ref/c/cl/void //apple_ref/c/cl/void //apple_ref/c/tdef/void //apple_ref/c/tag/void //apple_ref/c/econst/void //apple_ref/c/struct/void //apple_ref/c/clconst/void" --><font class="type">void</font><!-- /a --> <font class="type">*</font> (*<!-- a logicalPath="//apple_ref/c/instm/patch_lookup_fn_t //apple_ref/c/clm/patch_lookup_fn_t //apple_ref/c/intfcm/patch_lookup_fn_t //apple_ref/c/func/patch_lookup_fn_t //apple_ref/c/ftmplt/patch_lookup_fn_t //apple_ref/c/defn/patch_lookup_fn_t //apple_ref/c/macro/patch_lookup_fn_t" --><font class="function">patch_lookup_fn_t</font><!-- /a -->)(
    <!-- a logicalPath="//apple_ref/c/cl/void //apple_ref/c/cl/void //apple_ref/c/tdef/void //apple_ref/c/tag/void //apple_ref/c/econst/void //apple_ref/c/struct/void //apple_ref/c/clconst/void" --><font class="type">void</font><!-- /a --> *<font class="param">patched_fn_addr</font> ); </pre></blockquote>
<h5><font face="Lucida Grande,Helvetica,Arial">Parameter Descriptions</font></h5>
<blockquote>
<dl><dt><code>patched_fn_addr</code></dt><dd>The address of the target function.</dd>
</dl>
</blockquote>
<dl><dt><i> result</i></dt><dd>The re-entry address normally returned from
<!-- a logicalPath="//apple_ref/c/func/DPCreatePatch" -->DPCreatePatch <!-- /a -->.
 </dd>
<h5><font face="Lucida Grande,Helvetica,Arial">Discussion</font></h5><p>A pointer to a function matching this prototype is passed
into the <!-- a logicalPath="//apple_ref/c/tdef/patch_link_fn_t" -->patch_link_fn_t <!-- /a -->
implemented by the Rosetta patch bundle.
</p>
</dl>
<p><p>&#169; 2003-2006 Jim Dovey. Some Rights Reserved.
 (Last Updated November 06, 2006)
</p></body></html>
